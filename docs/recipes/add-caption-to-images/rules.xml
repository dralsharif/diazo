<?xml version="1.0" encoding="UTF-8"?>
<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:template css:match="div#content-core img:not([title=''])">
    <figure class="captioned">
      <xsl:attribute name="class">
        <xsl:value-of select="concat(@class, ' captioned')"/>
      </xsl:attribute>
      <xsl:copy>
          <xsl:copy-of select="@*" />
          <xsl:apply-templates />
      </xsl:copy>
      <div class="image-caption">
        <xsl:value-of select="./@title" />
      </div>
      <div class="image-alt-desc">
        <xsl:value-of select="./@alt" />
      </div>
    </figure>
  </xsl:template>

</rules>
